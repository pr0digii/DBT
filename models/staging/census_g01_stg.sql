{{ config(materialized='table') }}

WITH raw_data AS (
  SELECT
    lga_code_2016::varchar AS lga_code_2016,
    tot_p_m::int AS Tot_P_M,
    tot_p_f::int AS Tot_P_F,
    tot_p_p::int AS Tot_P_P,
    age_0_4_yr_m::int AS Age_0_4_yr_M,
    age_0_4_yr_f::int AS Age_0_4_yr_F,
    age_0_4_yr_p::int AS Age_0_4_yr_P,
    age_5_14_yr_m::int AS Age_5_14_yr_M,
    age_5_14_yr_f::int AS Age_5_14_yr_F,
    age_5_14_yr_p::int AS Age_5_14_yr_P,
    age_15_19_yr_m::int AS Age_15_19_yr_M,
    age_15_19_yr_f::int AS Age_15_19_yr_F,
    age_15_19_yr_p::int AS Age_15_19_yr_P,
    age_20_24_yr_m::int AS Age_20_24_yr_M,
    age_20_24_yr_f::int AS Age_20_24_yr_F,
    age_20_24_yr_p::int AS Age_20_24_yr_P,
    age_25_34_yr_m::int AS Age_25_34_yr_M,
    age_25_34_yr_f::int AS Age_25_34_yr_F,
    age_25_34_yr_p::int AS Age_25_34_yr_P,
    age_35_44_yr_m::int AS Age_35_44_yr_M,
    age_35_44_yr_f::int AS Age_35_44_yr_F,
    age_35_44_yr_p::int AS Age_35_44_yr_P,
    age_45_54_yr_m::int AS Age_45_54_yr_M,
    age_45_54_yr_f::int AS Age_45_54_yr_F,
    age_45_54_yr_p::int AS Age_45_54_yr_P,
    age_55_64_yr_m::int AS Age_55_64_yr_M,
    age_55_64_yr_f::int AS Age_55_64_yr_F,
    age_55_64_yr_p::int AS Age_55_64_yr_P,
    age_65_74_yr_m::int AS Age_65_74_yr_M,
    age_65_74_yr_f::int AS Age_65_74_yr_F,
    age_65_74_yr_p::int AS Age_65_74_yr_P,
    age_75_84_yr_m::int AS Age_75_84_yr_M,
    age_75_84_yr_f::int AS Age_75_84_yr_F,
    age_75_84_yr_p::int AS Age_75_84_yr_P,
    age_85ov_m::int AS Age_85ov_M,
    age_85ov_f::int AS Age_85ov_F,
    age_85ov_p::int AS Age_85ov_P,
    counted_census_night_home_m::int AS Counted_Census_Night_home_M,
    counted_census_night_home_f::int AS Counted_Census_Night_home_F,
    counted_census_night_home_p::int AS Counted_Census_Night_home_P,
    count_census_nt_ewhere_aust_m::int AS Count_Census_Nt_Ewhere_Aust_M,
    count_census_nt_ewhere_aust_f::int AS Count_Census_Nt_Ewhere_Aust_F,
    count_census_nt_ewhere_aust_p::int AS Count_Census_Nt_Ewhere_Aust_P
  FROM {{ source('raw', 'census_2016') }}
)

SELECT
  CAST(SUBSTR(lga_code_2016, 4) AS INT) AS clean_lga_code,
  lga_code_2016,
  Tot_P_M,
  Tot_P_F,
  Tot_P_P,
  Age_0_4_yr_M,
  Age_0_4_yr_F,
  Age_0_4_yr_P,
  Age_5_14_yr_M,
  Age_5_14_yr_F,
  Age_5_14_yr_P,
  Age_15_19_yr_M,
  Age_15_19_yr_F,
  Age_15_19_yr_P,
  Age_20_24_yr_M,
  Age_20_24_yr_F,
  Age_20_24_yr_P,
  Age_25_34_yr_M,
  Age_25_34_yr_F,
  Age_25_34_yr_P,
  Age_35_44_yr_M,
  Age_35_44_yr_F,
  Age_35_44_yr_P,
  Age_45_54_yr_M,
  Age_45_54_yr_F,
  Age_45_54_yr_P,
  Age_55_64_yr_M,
  Age_55_64_yr_F,
  Age_55_64_yr_P,
  Age_65_74_yr_M,
  Age_65_74_yr_F,
  Age_65_74_yr_P,
  Age_75_84_yr_M,
  Age_75_84_yr_F,
  Age_75_84_yr_P,
  Age_85ov_M,
  Age_85ov_F,
  Age_85ov_P,
  Counted_Census_Night_home_M,
  Counted_Census_Night_home_F,
  Counted_Census_Night_home_P,
  Count_Census_Nt_Ewhere_Aust_M,
  Count_Census_Nt_Ewhere_Aust_F,
  Count_Census_Nt_Ewhere_Aust_P
FROM raw_data
